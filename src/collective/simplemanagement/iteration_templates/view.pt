<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="collective.simplemanagement">
  <body>

    <metal:title fill-slot="content-title">
      <div id="iteration-dates"
          tal:define="dates view/get_dates">
        <span tal:content="dates/start"/>&nbsp;&dash;&nbsp;<span
          tal:content="dates/end" />
      </div>

      <h1 metal:use-macro="context/kss_generic_macros/macros/generic_title_view">
           Generic KSS Title. Is rendered with class="documentFirstHeading".
      </h1>
    </metal:title>

    <metal:content-core fill-slot="content-core">
      <metal:block define-macro="content-core"
        tal:define="stories view/stories;
                  totals view/totals;
                  view_details python:True;
                  can_edit view/user_can_edit">

        <div tal:condition="view/user_can_add_story"
             id="addstory-container" class="clearfix simplemanagement-addstory">
          <h3><a i18n:translate="" href="#">Add Story</a></h3>
          <div id="addstory-form" style="display: none"
               class="simplemanagement-addstory-form-wrapper"
            tal:content="structure view/add_story_form" />
        </div>


        <div tal:condition="stories" id="stories-wrapper">

          <table class="listing stories">
            <thead>
              <tr>
                <th i18n:translate="">Story</th>
                <th i18n:translate="">Epic</th>
                <th i18n:translate="">Milestone</th>
                <th i18n:translate="">Estimate</th>
                <th i18n:translate="">Done</th>
                <th i18n:translate="">Difference</th>
                <th i18n:translate="">Booking</th>
                <th i18n:translate="">Actions</th>
              </tr>
            </thead>
            <tbody>
              <tal:stories repeat="story stories">
                <metal:stories
                  use-macro="context/simpemanagement-macros/story-compact">
                  <metal:extra-info fill-slot="extra-info">
                    <td class="info">
                      <metal:story-epic
                         use-macro="context/simpemanagement-macros/story-epic" />
                    </td>
                    <td class="info">
                      <metal:story-milestone
                         use-macro="context/simpemanagement-macros/story-milestone" />
                    </td>
                  </metal:extra-info>
                  <metal:after-columns fill-slot="after-columns">
                    <td class="quick-booking">
                      <a i18n:translate=""
                         class="bookform"
                         title="Add Booking"
                         i18n:attributes="title"
                         tal:attributes="rel string:${story/url}/create_booking">Book time</a>
                    </td>
                    <td class="actions">
                      <metal:story-actions
                        use-macro="context/simpemanagement-macros/story-actions" />
                    </td>
                  </metal:after-columns>
                </metal:stories>
              </tal:stories>
            </tbody>
          </table>
        </div>
        <div tal:condition="not:stories">
          <p class="discreet"
              i18n:translate="">
              No stories in this iteration.
              Add a new one or bring them in via the iteration planner.
          </p>
        </div>

        <metal:booking-form
          use-macro="context/simpemanagement-macros/booking-form" />
      </metal:block>
    </metal:content-core>

  </body>
</html>
