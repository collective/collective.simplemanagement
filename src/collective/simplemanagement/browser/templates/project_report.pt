<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="collective.simplemanagement">

  <body metal:use-macro="content">

    <metal:bodytext fill-slot="main">
      <metal:main define-macro="main"
        tal:define="helpers context/@@sm_helpers;
                    details view/details_report;
                    monthly view/monthly_report;
                    resources view/resources;">

        <div tal:replace="structure provider:plone.abovecontenttitle" />

        <h1 class="documentFirstHeading"
            i18n:translate="">Your report</h1>

        <div tal:replace="structure provider:plone.abovecontentbody" />
        <div id="content-core">

          <div id="overview">
            <ul class="tabs">
              <li><a href="#synoptic"
                i18n:translate="">Sinottica</a></li>
              <li><a href="#details"
                i18n:translate="">Details</a></li>
            </ul>
            <div class="panes">
              <div id="synoptic" class="pane">

                <form tal:attributes="action view/__name__">
                  <!-- <select name="month">
                    <tal:opt repeat="month view/months">
                      <option
                        tal:attributes="value month/value;
                                        selected month/selected"
                        tal:content="month/label"
                        />
                    </tal:opt>
                  </select> -->
                  <select name="year">
                    <tal:opt repeat="year view/years">
                      <option
                        tal:attributes="value year/value;
                                        selected year/selected"
                        tal:content="year/label"
                        />
                    </tal:opt>
                  </select>
                  <select name="employee">
                    <option value="all" i18n:translate="">All</option>
                    <tal:opt repeat="resource resources">
                      <option
                        tal:attributes="value resource/user_id;
                                        selected resource/selected;"
                        tal:content="resource/fullname"
                        />
                    </tal:opt>
                  </select>
                  <input type="submit" value="Filter" />
                </form>

                <div class="results">
                  <ul class="month" tal:repeat="month monthly">
                    <li>
                      <span class="label" tal:content="month/label" />
                      <span class="label" i18n:translate="">
                        Total: <span class="total"
                                     i18n:name="month_total"
                                     tal:content="month/total" />
                      </span>
                      <ul class="week" tal:repeat="week month/weeks/keys">
                        <li>
                          <span class="label" i18n:translate="">
                            Settimana <span i18n:name="weekno"
                                            tal:content="repeat/week/number" />:
                            <span class="total"
                                  i18n:name="week_total"
                                  tal:content="python:month['weeks'][week]" />
                          </span>
                        </li>
                      </ul>
                    </li>
                  </ul>
                </div>
                
              </div>
              <div id="booking-wrapper" class="pane">
                <div class="filters">
                  <form tal:attributes="action view/__name__">
                    <select name="month">
                      <tal:opt repeat="month view/months">
                        <option
                          tal:attributes="value month/value;
                                          selected month/selected"
                          tal:content="month/label"
                          />
                      </tal:opt>
                    </select>
                    <select name="year">
                      <tal:opt repeat="year view/years">
                        <option
                          tal:attributes="value year/value;
                                          selected year/selected"
                          tal:content="year/label"
                          />
                      </tal:opt>
                    </select>
                    <select name="employee">
                      <option value="all" i18n:translate="">All</option>
                      <tal:opt repeat="resource resources">
                        <option
                          tal:attributes="value resource/user_id;
                                          selected resource/selected;"
                          tal:content="resource/fullname"
                          />
                      </tal:opt>
                    </select>
                    <input type="submit" value="Filter" />
                  </form>
                </div>
                <div tal:condition="not: details">
                  <span class="label"
                    i18n:translate="">
                    You have no bookings yet
                  </span>
                </div>

                <table class="listing"
                       tal:condition="details">
                  <thead>
                    <tr>
                      <th i18n:translate="">Date</th>
                      <th i18n:translate="">Log</th>
                      <th i18n:translate="">Employee</th>
                      <th i18n:translate="">Hours</th>
                    </tr>
                  </thead>
                   <tbody>
                    <tr tal:repeat="book details">
                      <td>
                        <span tal:content="book/date">today</span>
                      </td>
                      <td>
                        <a tal:attributes="href book/url"
                           tal:content="book/title">closed ticket #1
                        </a>
                      </td>
                      <td>
                        <span tal:content="book/user/fullname">John Doe</span>
                        (<span class="discreet"
                               tal:content="book/user/user_id">j.doe</span>)
                      </td>
                      <td tal:content="book/time">3.0</td>
                    </tr>
                  </tbody>
                </table>

              </div>

            </div>
          </div>
        </div>

        <div tal:replace="structure provider:plone.belowcontentbody" />
      </metal:main>
    </metal:bodytext>
  </body>
</html>
